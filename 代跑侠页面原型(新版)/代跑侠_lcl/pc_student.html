<!DOCTYPE html>
<html>
<head>
	<title>mywallet</title>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- ZUI 标准版压缩后的 CSS 文件 -->
    <link href="css/zui.min.css" rel="stylesheet">
	<!-- ZUI Javascript 依赖 jQuery -->
	<script src="js/jquery-1.7.min.js"></script>
	<!-- ZUI 标准版压缩后的 JavaScript 文件 -->
	<script src="js/zui.min.js"></script>
	<script src="js/zui.jedate.js"></script>
	<!--****************自定义CSS**************-->
	<link rel="stylesheet" href="css/pc_student.css">
	<link href="css/style.css" rel="stylesheet">
	<script src="js/iconfont.js"></script>
	<!--******************外部引用包************-->
</head>
<body>
	<div class="banner">
		<a href="pc_login.html"><img src="images/personalCenter/backblack.png" class="back"></a>
		学生实人认证
	</div>
	<div class="card">
		<span class="card01">我的学生证</span>
		<img src="images/personalCenter/safe.png" class="safe">
		<span class="card02">学生实人认证是保证的个人快递安全的第一道凭证</span>
		<div class="card03">未认证</div>
	</div>
	<div class="massages">
		<div class="massages01">
			<span>上传学生证高清照片以认证</span>
		</div>
		<div class="massages02">	
			<!--上传照片组件-->
			<img id="preview" />
    		<br/>
    		<input type="file" name="file" onchange="imgPreview(this)" class="file" />
		</div>
		<div class="massages02">	
			<!--上传照片组件-->
			<img id="preview" />
    		<br/>
    		<input type="file" name="file" onchange="imgPreview(this)" class="file" />
			<!-- <div id = "result"></div>
    		<input id="pic" type="file" name = 'pic' accept = "image/*" onchange = "selectFile()"/>
    		<!- <button onclick = "handIn()">提交</button> --> 
		</div>
		<div class="space">
			<input type="radio" name="agree">我同意<a href="#">《安全协议》</a>	
		</div>
		<div class="space">
			<a href="pc_login.html"><button>确定认证</button></a>
		</div>
	</div>



</body>
<script type="text/javascript">
    function imgPreview(fileDom){
        //判断是否支持FileReader
        if (window.FileReader) {
            var reader = new FileReader();
        } else {
            alert("您的设备不支持图片预览功能，如需该功能请升级您的设备！");
        }

        //获取文件
        var file = fileDom.files[0];
        var imageType = /^image\//;
        //是否是图片
        if (!imageType.test(file.type)) {
            alert("请选择图片！");
            return;
        }
        //读取完成
        reader.onload = function(e) {
            //获取图片dom
            var img = document.getElementById("preview");
            //图片路径设置为读取的图片
            img.src = e.target.result;
        };
        reader.readAsDataURL(file);
    }
</script>
<script type="text/javascript">
    function upload() {
        var xhr = new XMLHttpRequest();
        var progress = document.getElementById("progress")
        progress.style.display = "block";

        xhr.upload.addEventListener("progress", function(e) {
            if (e.lengthComputable) {
                var percentage = Math.round((e.loaded * 100) / e.total);
                progress.value = percentage;
            }
        }, false);

        xhr.upload.addEventListener("load", function(e){
              console.log("上传完毕...")
          }, false);

        xhr.open("POST", "upload");
        xhr.overrideMimeType('text/plain; charset=x-user-defined-binary');
        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4 && xhr.status == 200) {
                alert(xhr.responseText); // handle response.
                progress.style.display = "none";
                progress.value = 0;
            }
        };
        var file = document.getElementById("imgFile");
        var fd = new FormData();
        fd.append(file.files[0].name, file.files[0]);
        xhr.send(fd);
    }
</script>
<!--**************************-->
<style type="text/css">
        #result{
            width: 200px;
            height:112px;
            border:1px solid #eee;
        }
        #result img{
            width: 200px;
        }
        input{
            width: 70px;
            margin-top: 10px;
        }
        @-moz-document url-prefix() { input { width:65px; } }/*单独对火狐进行设置*/
</style>
 <script type="text/javascript">
        //var files = document.getElementById('pic').files;
        var form = new FormData();//通过HTML表单创建FormData对象
        var url = '127.0.0.1:8080/'
        function selectFile(){
            var files = document.getElementById('pic').files;
            console.log(files[0]);
            if(files.length == 0){
                return;
            }
            var file = files[0];
            //把上传的图片显示出来
            var reader = new FileReader();
            // 将文件以Data URL形式进行读入页面
            console.log(reader);
            reader.readAsBinaryString(file);
            reader.onload = function(f){
                var result = document.getElementById("result");
                var src = "data:" + file.type + ";base64," + window.btoa(this.result);
                result.innerHTML = '<img src ="'+src+'"/>';
            }
            console.log('file',file);
            ///////////////////
            form.append('file',file);
            console.log(form.get('file'));
        }
        //var xhr = new XMLHttpRequest();
        // function handIn(){
        //  console.log(form.get('file'));
        //  xhr.open("post", url, true);
        //  xhr.addEventListener("readystatechange", function() {  
        //      var result = xhr;  
        //      if (result.status != 200) { //error  
        //          console.log('上传失败', result.status, result.statusText, result.response);  
        //      }   
        //      else if (result.readyState == 4) { //finished  
        //          console.log('上传成功', result);  
        //      }  
        //  });   
        // }
    </script>

</html>